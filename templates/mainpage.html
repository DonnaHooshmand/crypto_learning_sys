<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>LearnCrypto</title>
    <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/mainpage.css') }}">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript">
        function show_motivation() {
            var val1 = document.getElementById("opt");
            var droptext1 = val1.options[val1.selectedIndex].text;
            var val2 = document.getElementById("ende");
            var droptext2 = val2.options[val2.selectedIndex].text;
            if (droptext1 == "RSA") {
                document.getElementById("word1").innerHTML = "The Rivet-Shamir-Adleman (RSA) ";
                document.getElementById("word2").innerHTML = "The Rivet-Shamir-Adleman (RSA) Cryptosystem is an asymmetric cryptosystem that is used today by modern computers to encrypt and decrypt messages. Asymmetric means that there are two different keys. It is also classified as a public key cryptosystem since one of the keys can be given to anyone. RSA is based on the principle that it is easy to multiply large numbers, but factoring large numbers is very difficult. ";
                document.getElementById("word3").innerHTML = "RSA is used today in modern computers. It is used in a range of web browsers, email, VPNs, chat and other communication channels and it is considered the most secure way of encryption. So, it is a very valuable cryptosystem to learn for many computer scientists!";
            }
            else if (droptext1 == "Diffie–Hellman key exchange") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "Diffie–Hellman key exchange motivation!";
                document.getElementById("word3").innerHTML = "";
            }
            else if (droptext1 == "ElGamal encryption") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "ElGamal encryption motivation!";
                document.getElementById("word3").innerHTML = "";
            }
        }

        function show_text() {
            var val1 = document.getElementById("opt");
            var droptext1 = val1.options[val1.selectedIndex].text;
            var val2 = document.getElementById("ende");
            var droptext2 = val2.options[val2.selectedIndex].text;

            if (droptext1 == "RSA" && droptext2 == "Encrypt") {
                for (var i = 2; i < 25; i++) {
                    var id = "word" + i;
                    document.getElementById(id).style.textDecoration = "none";
                }
                var web = "https://bigprimes.org";
                document.getElementById("word2").innerHTML = "Before we begin the encryption method, there are a few things we must set up. ";
                document.getElementById("word3").style.textDecoration = 'underline';
                document.getElementById("word3").innerHTML = "Step 1: pick two -large- primes";
                document.getElementById("word4").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp The bigger the prime, the more secure the system is. For better visualization and understanding, I will use two smaller primes:  p = 11  and q = 3";
                document.getElementById("word5").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp If you want to try larger numbers, I would suggest checking out this website: " + web.link("https://bigprimes.org");
                document.getElementById("word6").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp Easy enough! Next step! ";
                document.getElementById("word7").style.textDecoration = 'underline';
                document.getElementById("word7").innerHTML = "Step 2: find N(modulus) and Euler’s Phi";
                document.getElementById("word8").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp N is the product of the two primes we picked earlier, it’s simply: N = p*q";
                document.getElementById("word9").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp With my example, N = 3*11 = 33";
                document.getElementById("word10").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp As for Euler’s Phi function, it’s:  ϕ = (p-1)(q-1).       (attach popup 1)";
                document.getElementById("word11").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp With the nubes above, it is: (11-1)(3-1)=20";
                document.getElementById("word12").style.textDecoration = 'underline';
                document.getElementById("word12").innerHTML = "Step 3: Find e, the public exponent";
                document.getElementById("word13").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp We must choose an integer e such that: 1 < e < ϕ , and: gcd(e,ϕ) = 1, (If you can’t think of one, we can find a random e for you)!";
                document.getElementById("word14").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp We must find an example such that gcd(e,20) = 1. 3 fits this criteria! So, e = 3.";
                document.getElementById("word15").style.textDecoration = 'underline';
                document.getElementById("word15").innerHTML = "Step 4: Send out the public key!";
                document.getElementById("word16").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp Public key = (N,e) which in our example is (33,3)";
                document.getElementById("word17").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp Now the encryption begins!";
                document.getElementById("word18").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp Let’s suppose Alice wants to send a message to Bob. What does she have to do?";
                document.getElementById("word19").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp 1.	Pick a message m to encrypt. In our example, we will use m = 7";
                document.getElementById("word20").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp 2.	Obtain Bob’s public key (N,e) to compute the ciphertext: c ≡ m" + "e".sup() + "mod N.";
                document.getElementById("word21").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp Which is, 7^(3 ) mod 33 ⇔343 mod 33 ⇔ 13 mod 33";
                document.getElementById("word22").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp So, our ciphertext is 13.";
                document.getElementById("word23").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp 3.	Send the Cipher text to Bob!";
                document.getElementById("word24").innerHTML = "Encryption is done! Click decryption to see how to decrypt the message! ";

                for (var i = 1; i < 5; i++) {
                    var id1 = "text" + i;
                    var id2 = "input" + i;
                    document.getElementById(id1).style.display = 'inline-block';
                    document.getElementById(id2).style.display = 'inline-block';
                }

                document.getElementById("text1").innerHTML = "Prime p: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp";
                document.getElementById("text2").innerHTML = "Prime q: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp";
                document.getElementById("text3").innerHTML = "Exponent e: &nbsp&nbsp&nbsp";
                document.getElementById("text4").innerHTML = "text you want to encrypt: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp";
            }
            else if (droptext1 == "RSA" && droptext2 == "Decrypt") {
                for (var i = 2; i < 25; i++) {
                    var id = "word" + i;
                    document.getElementById(id).style.textDecoration = "none";
                    document.getElementById(id).innerHTML = "";
                }
                document.getElementById("word2").innerHTML = "Recall, We already know p, q, and the public key (N,e). ";
                document.getElementById("word3").innerHTML = "There is one simple step Bob has to do before starting the encryption:";
                document.getElementById("word4").style.textDecoration = 'underline';
                document.getElementById("word4").innerHTML = "Generate private key";
                document.getElementById("word5").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp For this step, Bob has to compute the secret exponent d such that: 1<d<ϕ, and ed ≡ 1 mod ϕ (attach popup 2)";
                document.getElementById("word6").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp In our example, we must find a value such that 3d ≡ 1 mod 20";
                document.getElementById("word7").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp Using simple methods learned in discrete math, we are looking for a d such that 20 divides 3d-1. Since our numbers are very small we can test and see that 7 works. d = 7.";
                document.getElementById("word8").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp So the private key is: which in our example is (33,7)";
                document.getElementById("word9").style.textDecoration = 'underline';
                document.getElementById("word9").innerHTML = "Now the decryption begins! ";
                document.getElementById("word10").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp Bob only has to do one thing: ";
                document.getElementById("word11").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp Compute m’ ≡ c" + "d".sup() +" mod N. m’ will equal the plaintext m! "
                document.getElementById("word12").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp In our example we will have ";
                document.getElementById("word13").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp Alice sent Bob the ciphertext c = 13. ";
                document.getElementById("word14").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp Bob will compute the following: ";
                document.getElementById("word15").innerHTML = "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp m’ ≡ c" + "d".sup() + "mod N &hArr; 13" +"7".sup() +"mod 33 &hArr; 7";
                document.getElementById("word16").innerHTML = "Note: We don’t have to compute the full value of 13^7. we can factor and make use of the fact that: ";
                document.getElementById("word17").innerHTML = "A = bc mod n ⇔(b mod n)(c mod n) mod n";
                document.getElementById("word18").innerHTML = "Done!  :)";


                for (var i = 1; i < 5; i++) {
                    var id1 = "text" + i;
                    var id2 = "input" + i;
                    document.getElementById(id1).style.display = 'inline-block';
                    document.getElementById(id2).style.display = 'inline-block';
                }
            }
            else if (droptext1 == "Diffie–Hellman key exchange" && droptext2 == "Encrypt") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "Diffie–Hellman key exchange encrypt example!";
                document.getElementById("word3").innerHTML = "";
            }
            else if (droptext1 == "Diffie–Hellman key exchange" && droptext2 == "Decrypt") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "Diffie–Hellman key exchange decrypt example!";
                document.getElementById("word3").innerHTML = "";
            }
            else if (droptext1 == "ElGamal encryption" && droptext2 == "Encrypt") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "ElGamal encryption encrypt example!";
                document.getElementById("word3").innerHTML = "";
            }
            else if (droptext1 == "ElGamal encryption" && droptext2 == "Decrypt") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "ElGamal encryption decrypt example!";
                document.getElementById("word3").innerHTML = "";
            }
            else if(droptext1 == "RSA" && droptext2 == "Select an Option") {
                document.getElementById("word1").innerHTML = "The Rivet-Shamir-Adleman (RSA) ";
                document.getElementById("word2").innerHTML = "The Rivet-Shamir-Adleman (RSA) Cryptosystem is an asymmetric cryptosystem that is used today by modern computers to encrypt and decrypt messages. Asymmetric means that there are two different keys. It is also classified as a public key cryptosystem since one of the keys can be given to anyone. RSA is based on the principle that it is easy to multiply large numbers, but factoring large numbers is very difficult. ";
                document.getElementById("word3").innerHTML = "RSA is used today in modern computers. It is used in a range of web browsers, email, VPNs, chat and other communication channels and it is considered the most secure way of encryption. So, it is a very valuable cryptosystem to learn for many computer scientists!";
            }
            else if(droptext1 == "Diffie–Hellman key exchange" && droptext2 == "Select an Option") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "Diffie–Hellman key exchange motivation!";
                document.getElementById("word3").innerHTML = "";
            }
            else if (droptext1 == "ElGamal encryption" && droptext2 == "Select an Option") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "ElGamal encryption motivation!";
                document.getElementById("word3").innerHTML = "";
            }
            else if (droptext1 == "Select an Option" && droptext2 == "Encrypt") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "";
                document.getElementById("word3").innerHTML = "";
            }
            else if (droptext1 == "Select an Option" && droptext2 == "Decrypt") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "";
                document.getElementById("word3").innerHTML = "";
            }
            else {
                document.getElementById("word1").innerHTML = "Unknown requirements";
            }
        }

        function click_motivation() {
            var text = document.getElementById("whysys").innerHTML;
            if (text == "why RSA") {
                document.getElementById("word1").innerHTML = "The Rivet-Shamir-Adleman (RSA) ";
                document.getElementById("word2").innerHTML = "Cryptosystem is a asymmetric cryptosystem that is used today by modern computers to encrypt and decrypt messages! Asymmetric means that there are two different keys. It is also classified as a public key cryptosystem since one of the keys can be given to anyone. \n" +
                    "RSA is based on the principle that it is easy to multiply large numbers, but factoring large numbers is very difficult. ";
                document.getElementById("word3").innerHTML = "RSA is used today in modern computers. It is used in a range of web browsers, email, VPNs, chat and other communication channels. So, it is a very valuable cryptosystem to learn for many computer scienctists!";
                for (var i = 4; i < 25; i++) {
                    var id = "word" + i;
                    document.getElementById(id).innerHTML = "";
                }
            }
            else if (text == "why Diffie–Hellman key exchange") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "Diffie–Hellman key exchange motivation!";
                document.getElementById("word3").innerHTML = "";
            }
            else if (text == "why ElGamal encryption") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "ElGamal encryption motivation!";
                document.getElementById("word3").innerHTML = "";
            }
        }

        function why_system() {
            var val = document.getElementById("opt");
            var chosen = val.options[val.selectedIndex].text;
            if (chosen != "Select an Option") {
                var combine = "why " + chosen;
                document.getElementById("whysys").innerHTML = combine;
            }
            else {
                document.getElementById("whysys").innerHTML = "Let's choose a crypto system!";
            }
        }

        function validateForm() {
            if (document.getElementById("opt").value != "none" && document.getElementById("ende").value != "none") {
                return true;
            }
            //Handle error message here.
            alert("Please select a category");
            return false;
        }

        function toggle_visibility() 
        {
            var e = document.getElementById("butt");
            var val1 = document.getElementById("opt");
            var droptext1 = val1.options[val1.selectedIndex].text;
            var val2 = document.getElementById("ende");
            var droptext2 = val2.options[val2.selectedIndex].text;
            
            if (droptext1 != "Select an Option" && droptext2 != "Select an Option")
                e.style.display = 'inline-block';
        }

        function show_dice1() {
            var img = document.createElement('img');
            img.src = "https://gilkalai.files.wordpress.com/2017/09/dice.png";
            img.width = "30";
            var myp = document.getElementById("img1");
            myp.appendChild(img);
        }

        function show_dice2() {
            var img = document.createElement('img');
            img.src = "https://gilkalai.files.wordpress.com/2017/09/dice.png";
            img.width = "30";
            var myp = document.getElementById("img2");
            myp.appendChild(img);
        }

        function show_dice3() {
            var img = document.createElement('img');
            img.src = "https://gilkalai.files.wordpress.com/2017/09/dice.png";
            img.width = "30";
            var myp = document.getElementById("img3");
            myp.appendChild(img);
        }

        $(document).ready(function(){
			$("#butt").click(function(){
                $.ajax({
                    url: '/process',
                    type: 'POST',
                    data: {userInput1: $("#input1").val(),
                           userInput2: $("#input2").val(),
                           userInput3: $("#input3").val(),
                           userInput4: $("#input4").val()}
                })
                .done(function(data) {
                    if (data.length == 2) {
                        if (data[0] == "0" && data[1] == "0") {
                            $("#err1").html("p has to be a prime");
                            $("#err2").html("q has to be a prime");
                        }
                        else if (data[0] == "0") {
                            $("#err1").html("p has to be a prime");
                        }
                        else if (data[1] == "0") {
                            $("#err2").html("q has to be a prime");
                        }
                    }
                    else if (data.length == 5)
                        $("#err3").html("e is not a valid number, please read the example one more time!");
                    else {
                        // show steps here
                    }
                });
			});
		});


    </script>
</head>

<body>

<br/><br/><br/><br/><br/><br/>

<h1>Welcome to Cryptography Interactive Learning System!</h1>

<span class="color-picker"></span>

<br/><br/><br/>

<!-- <form action="_choose" onsubmit="return validateForm()" method="GET|POST"></form> -->
<span class="dropdown_leading">
    I want to learn: &nbsp&nbsp&nbsp
</span>
<span class="custom-dropdown big">
    <select name="cryptosystem" id="opt" onchange="show_text(); why_system(); toggle_visibility();" >
        <option value="none" selected disabled hidden>
            Select an Option
        </option>
        <option>RSA</option>
        <option>Diffie–Hellman key exchange</option>
        <option>ElGamal encryption</option>
    </select>
</span>

<br/><br/>

<span class="dropdown_leading">
    How it works? &nbsp&nbsp&nbsp&nbsp&nbsp
</span>
<div class="custom-dropdown big">
    <select name="en_de" id="ende" onchange="toggle_visibility(); show_text();">
        <option value="none" selected disabled hidden>
            Select an Option
        </option>
        <option>Encrypt</option>
        <option>Decrypt</option>
    </select>
</div>

<br/><br/><br/><br/>

<span id="whysys" onclick="click_motivation();">

</span>

<br/><br/>

<p class="title" id="word1"></p>

<p class="word" id="word2"></p>

<p class="word" id="word3"></p>

<p class="word" id="word4"></p>

<p class="word" id="word5"></p>

<p class="word" id="word6"></p>

<p class="word" id="word7"></p>

<p class="word" id="word8"></p>

<p class="word" id="word9"></p>

<p class="word" id="word10"></p>

<p class="word" id="word11"></p>

<p class="word" id="word12"></p>

<p class="word" id="word13"></p>

<p class="word" id="word14"></p>

<p class="word" id="word15"></p>

<p class="word" id="word16"></p>

<p class="word" id="word17"></p>

<p class="word" id="word18"></p>

<p class="word" id="word19"></p>

<p class="word" id="word20"></p>

<p class="word" id="word21"></p>

<p class="word" id="word22"></p>

<p class="word" id="word23"></p>

<p class="word" id="word24"></p>

<p class="word" id="word25"></p>

<p class="word" id="word26"></p>

<p class="word" id="word27"></p>

<p class="word" id="word28"></p>

<p class="word" id="word29"></p>

<p class="word" id="word30"></p>

<p class="word" id="word31"></p>

<p class="word" id="word32"></p>

<p class="word" id="word33"></p>

<label for="lname" class="box_leading" id="text1"></label>
<input type="text" class="box" id="input1" name="userInput1" onclick="show_dice1(); this.onclick=null;"><span>&nbsp&nbsp&nbsp</span><span id="img1"></span>
<p class="err" id="err1">&nbsp</p>
<br><br>
<label for="lname" class="box_leading" id="text2"></label>
<input type="text" class="box" id="input2" name="userInput2" onclick="show_dice2(); this.onclick=null;"><span>&nbsp&nbsp&nbsp</span><span id="img2"></span>
<p class="err" id="err2">&nbsp</p>
<br><br>
<label for="lname" class="box_leading" id="text3"></label>
<input type="text" class="box" id="input3" name="userInput3" placeholder="follow the example to find e" onclick="show_dice3(); this.onclick=null;"><span>&nbsp&nbsp&nbsp</span><span id="img3"></span>
<p class="err" id="err3">&nbsp</p>
<br><br>
<label for="lname" class="box_leading" id="text4"></label>
<br><br>
<textarea type="text" class="text_box" id="input4" name="userInput4" rows="10" cols="70"></textarea>
<br/><br/><br/><br/><br/><br/>

<div>
    <button class="button" id="butt">Try it yourself!</button>
</div>


<!-- </form> -->
</body>
</html>