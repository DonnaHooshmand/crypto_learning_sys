<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>LearnCrypto</title>
    <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/mainpage.css') }}">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript">
        function show_motivation() {
            var val1 = document.getElementById("opt");
            var droptext1 = val1.options[val1.selectedIndex].text;
            var val2 = document.getElementById("ende");
            var droptext2 = val2.options[val2.selectedIndex].text;
            if (droptext1 == "RSA") {
                document.getElementById("word1").innerHTML = "The Rivet-Shamir-Adleman (RSA) ";
                document.getElementById("word2").innerHTML = "The Rivet-Shamir-Adleman (RSA) Cryptosystem is an asymmetric cryptosystem that is used today by modern computers to encrypt and decrypt messages. Asymmetric means that there are two different keys. It is also classified as a public key cryptosystem since one of the keys can be given to anyone. RSA is based on the principle that it is easy to multiply large numbers, but factoring large numbers is very difficult. ";
                document.getElementById("word3").innerHTML = "RSA is used today in modern computers. It is used in a range of web browsers, email, VPNs, chat and other communication channels and it is considered the most secure way of encryption. So, it is a very valuable cryptosystem to learn for many computer scientists!";
            }
            else if (droptext1 == "Diffie–Hellman key exchange") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "Diffie–Hellman key exchange motivation!";
                document.getElementById("word3").innerHTML = "";
            }
            else if (droptext1 == "ElGamal encryption") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "ElGamal encryption motivation!";
                document.getElementById("word3").innerHTML = "";
            }
        }

        function show_text() {
            var val = document.getElementById("opt");
            var droptext = val.options[val.selectedIndex].text;

            if (droptext == "RSA") {
                for (var i = 2; i < 75; i++) {
                    var id = "word" + i;
                    document.getElementById(id).style.textDecoration = "none";
                    document.getElementById(id).innerHTML = "";
                    var jq_id = "#" + id;
                    $(jq_id).off("click");
                }
                var web1 = "https://bigprimes.org";
                $("#word2").html("Let's start with encryption: ");
                $("#word3").html("Method");
                document.getElementById("word4").style.textDecoration = 'underline';
                $("#word4").html("Step 1 of 4");
                $("#word5").html("Step 1: pick two -large- primes");
                $("#word6").html("The bigger the prime, the more secure the system is.");
                $("#word7").html("If you want to try larger numbers, I would suggest checking out this website: " + web1.link("https://bigprimes.org"));
                $("#word5").hide();
                $("#word6").hide();
                $("#word7").hide();
                $("#word4").click(function() {
                    $("#word5").fadeToggle();
                    $("#word6").fadeToggle();
                    $("#word7").fadeToggle();
                });
                document.getElementById("word8").style.textDecoration = 'underline';
                $("#word8").html("Step 2 of 4");
                $("#word9").html("Step 2: find N(modulus) and Euler’s Phi");
                $("#word10").html("N is the product of the two primes we picked earlier");
                $("#word11").html("As for Euler’s Phi function, it’s:  ϕ = (p-1)(q-1).");
                $("#word9").hide();
                $("#word10").hide();
                $("#word11").hide();
                $("#word8").click(function() {
                    $("#word9").fadeToggle();
                    $("#word10").fadeToggle();
                    $("#word11").fadeToggle();
                });
                document.getElementById("word12").style.textDecoration = 'underline';
                $("#word12").html("Step 3 of 4");
                $("#word13").html("Step 3: Find e, the public exponent");
                $("#word14").html("We must choose an integer e such that: 1 < e < ϕ , and: gcd(e,ϕ) = 1");
                document.getElementById("word15").style.textDecoration = 'underline';
                $("#word15").html("Step 4 of 4");
                $("#word16").html("Step 4: Send out the public key!");
                $("#word15").html("Public key = (N,e) ");




                document.getElementById("tryButt").style.display = 'inline-block';

                for (var i = 1; i < 5; i++) {
                    var id1 = "text" + i;
                    var id2 = "input" + i;
                    document.getElementById(id1).style.display = 'inline-block';
                    document.getElementById(id2).style.display = 'inline-block';
                }

                document.getElementById("text1").innerHTML = "Prime p: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp";
                document.getElementById("text2").innerHTML = "Prime q: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp";
                document.getElementById("text3").innerHTML = "Exponent e: &nbsp&nbsp&nbsp";
                document.getElementById("text4").innerHTML = "text you want to encrypt: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp";
            }
            else if (droptext == "Diffie–Hellman key exchange") {
                for (var i = 2; i < 25; i++) {
                    var id = "word" + i;
                    document.getElementById(id).style.textDecoration = "none";
                    document.getElementById(id).innerHTML = "";
                    var jq_id = "#" + id;
                    $(jq_id).off("click");
                }

                $("#word2").html("--Encryption-----------------------------------");
                $("#word3").html("Method");
                document.getElementById("word4").style.textDecoration = 'underline';
                $("#word4").html("Step 1 of 2");
                $("#word5").html("Step 1: Public Parameter Creation");
                $("#word6").html("A trusted party must choose and publish a (large) prime p, and an integer g having large prime order in F" + "*".sup() + "p".sub());
                $("#word5").hide();
                $("#word6").hide();
                $("#word4").click(function() {
                    $("#word5").fadeToggle();
                    $("#word6").fadeToggle();
                });
                document.getElementById("word7").style.textDecoration = 'underline';
                $("#word7").html("Step 2 of 2");
                $("#word8").html("Step 2: Private Computations");
                $("#word9").html("Alice:​ Alice chooses a secret integer a to compute A ≡ g" + "a".sup() + "(mod p)");
                $("#word10").html("Bob:​ Bob chooses a secret integer b to compute B ≡ g" + "b".sup() + "(mod p)");
                $("#word11").html("Now, Alice sends A to Bob, and Bob sends B to Alice. These values will be sent over the channel and are public.");
                $("#word12").html("In the decrypt section We will show how Alice and Bob compute the shared secret value.");
                $("#word8").hide();
                $("#word9").hide();
                $("#word10").hide();
                $("#word11").hide();
                $("#word12").hide();
                $("#word7").click(function() {
                    $("#word8").fadeToggle();
                    $("#word9").fadeToggle();
                    $("#word10").fadeToggle();
                    $("#word11").fadeToggle();
                    $("#word12").fadeToggle();
                });
                $("#word13").html("--Decryption-----------------------------------");
                $("#word14").html("Recall, Alice and Bob agree on a public prime and the primitive root g.");
                $("#word15").html("AlicehassentA≡ g" + "a".sup() + "(mod p)to Bob, and Bob has sent B≡ g" + "b".sup() + "(mod p) to Alice.");
                $("#word16").html("How to decrypt?");
                $("#word17").html("Alice​: Alice will now compute B" + "a".sup() + "(mod p )");
                $("#word18").html("Bob​: Bob will compute A" + "b".sup() + "(mod p)");
                $("#word19").html("The shared secret value is: B" + "a".sup() + "≡ (g" + "b".sup() +")" + "a".sup() + "≡ g" + "ab".sup() + "≡ (g" + "a".sup()+ ")" + "b".sup() + "≡ A" +"b".sup() + "(mod p)");
                $("#word20").html("Thus, they managed to create a private key over an insecure channel.");
                $("#word21").html("--Exmaple---------------------------------------");
                $("#word22").html("--Encryption-----------------------------------");
                document.getElementById("word23").style.textDecoration = 'underline';
                $("#word23").html("Step 1 of 2");
                $("#word24").html("Step 1: Public Parameter Creation");
                $("#word25").html("Alice and Bob agree to use the prime p = 941 and the primitive root g = 627.");
                $("#word24").hide();
                $("#word25").hide();
                $("#word23").click(function() {
                    $("#word24").fadeToggle();
                    $("#word25").fadeToggle();
                });
                document.getElementById("word26").style.textDecoration = 'underline';
                $("#word26").html("Step 2 of 2");
                $("#word27").html("Step 2: Private Computations");
                $("#word28").html("Alice: ​In our example, Alice chooses 347 and computes: A ≡ 627347 (mod 941) = 390");
                $("#word29").html("Bob:​ In our example, Bob chooses 781 and computes: B ≡ 627781 (mod 971) = 691");
                $("#word27").hide();
                $("#word28").hide();
                $("#word29").hide();
                $("#word26").click(function() {
                    $("#word27").fadeToggle();
                    $("#word28").fadeToggle();
                    $("#word29").fadeToggle();
                });
                $("#word30").html("--Decryption-----------------------------------");
                $("#word31").html("Recall, Alice and Bob agree on a public prime and the primitive root g.");
                $("#word32").html("AlicehassentA≡ g" + "a".sup() + "(mod p) to Bob, and Bob has sent B≡ g" + "b".sup() + "(mod p) to Alice.");
                $("#word33").html("In our example, p = 941, g = 627, a = 347, A = 390, b = 781, and B = 691.");
                $("#word34").html("The shared secret value is: B" + "a".sup() + "≡ (g" + "b".sup() + ")" +"a".sup() + "≡ g" + "ab".sup() + "≡ (g" + "a".sup() + ")" + "b".sup() + "≡ A" + "b".sup() + "(mod p)");
                $("#word35").html("In our example, B" + "a".sup() + "≡ A" + "b".sup() + "≡ 627" + "347*781".sup() + "(mod 941) ≡ 470");
                $("#word36").html("Their secret shared value is 470.");
                $("#word37").html("Thus, they managed to create a private key over an insecure channel.");

                for (var i = 39; i <= 75; i++) {
                    var id = "#word" + i;
                    $(id).hide();
                }

                $("#word38").html("Ready to try it yourself?");
                $("#word38").append("&nbsp&nbsp&nbsp&nbsp<button id='readyBtn'>Yeah!</button>");
                $("#readyBtn").click(function() {
                    for (var i = 39; i <= 75; i++) {
                    var id = "#word" + i;
                    $(id).show();
                    }
                });
                $("#word39").html("Learn what number to choose:&nbsp&nbsp&nbsp" + "https://bigprimes.org".link("https://bigprimes.org"));
                $("#word40").html("WolframeAlpha will help with your calculation: &nbsp&nbsp&nbsp" + "https://www.wolframalpha.com/".link("https://www.wolframalpha.com/"));
                for (var i = 1; i < 5; i++) {
                    var id1 = "text" + i;
                    var id2 = "input" + i;
                    document.getElementById(id1).style.display = 'inline-block';
                    document.getElementById(id2).style.display = 'inline-block';
                }
            }
            else if (droptext == "ElGamal encryption") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "ElGamal encryption encrypt example!";
                document.getElementById("word3").innerHTML = "";
            }
            else {
                document.getElementById("word1").innerHTML = "Unknown requirements";
            }
        }

        function click_motivation() {
            var text = document.getElementById("whysys").innerHTML;
            if (text == "why RSA") {
                document.getElementById("word1").innerHTML = "The Rivet-Shamir-Adleman (RSA) ";
                document.getElementById("word2").innerHTML = "Cryptosystem is a asymmetric cryptosystem that is used today by modern computers to encrypt and decrypt messages! Asymmetric means that there are two different keys. It is also classified as a public key cryptosystem since one of the keys can be given to anyone. \n" +
                    "RSA is based on the principle that it is easy to multiply large numbers, but factoring large numbers is very difficult. ";
                document.getElementById("word3").innerHTML = "RSA is used today in modern computers. It is used in a range of web browsers, email, VPNs, chat and other communication channels. So, it is a very valuable cryptosystem to learn for many computer scienctists!";
                for (var i = 4; i < 25; i++) {
                    var id = "word" + i;
                    document.getElementById(id).innerHTML = "";
                }
            }
            else if (text == "why Diffie–Hellman key exchange") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "Diffie–Hellman key exchange motivation!";
                document.getElementById("word3").innerHTML = "";
            }
            else if (text == "why ElGamal encryption") {
                document.getElementById("word1").innerHTML = "";
                document.getElementById("word2").innerHTML = "ElGamal encryption motivation!";
                document.getElementById("word3").innerHTML = "";
            }
        }

        function why_system() {
            var val = document.getElementById("opt");
            var chosen = val.options[val.selectedIndex].text;
            if (chosen != "Select an Option") {
                var combine = "why " + chosen;
                document.getElementById("whysys").innerHTML = combine;
            }
            else {
                document.getElementById("whysys").innerHTML = "Let's choose a crypto system!";
            }
        }

        function validateForm() {
            if (document.getElementById("opt").value != "none" && document.getElementById("ende").value != "none") {
                return true;
            }
            //Handle error message here.
            alert("Please select a category");
            return false;
        }

        function toggle_visibility() 
        {
            var e = document.getElementById("butt");
            var val1 = document.getElementById("opt");
            var droptext1 = val1.options[val1.selectedIndex].text;
            
            if (droptext1 != "Select an Option")
                e.style.display = 'inline-block';
        }

        function show_dice1() {
            var img = document.createElement('img');
            img.src = "https://gilkalai.files.wordpress.com/2017/09/dice.png";
            img.width = "30";
            var myp = document.getElementById("img1");
            myp.appendChild(img);
        }

        function show_dice2() {
            var img = document.createElement('img');
            img.src = "https://gilkalai.files.wordpress.com/2017/09/dice.png";
            img.width = "30";
            var myp = document.getElementById("img2");
            myp.appendChild(img);
        }

        function show_dice3() {
            var img = document.createElement('img');
            img.src = "https://gilkalai.files.wordpress.com/2017/09/dice.png";
            img.width = "30";
            var myp = document.getElementById("img3");
            myp.appendChild(img);
        }

        $(document).ready(function(){
			$("#butt").click(function(){
                $("#err1").html("&nbsp");
                $("#err2").html("&nbsp");
                $("#err3").html("&nbsp");
                $.ajax({
                    url: '/process',
                    type: 'POST',
                    data: {userInput1: $("#input1").val(),
                           userInput2: $("#input2").val(),
                           userInput3: $("#input3").val(),
                           userInput4: $("#input4").val()}
                })
                .done(function(data) {
                    if (data.length == 2) {
                        if (data[0] == "0" && data[1] == "0") {
                            $("#err1").html("p has to be a prime");
                            $("#err2").html("q has to be a prime");
                        }
                        else if (data[0] == "0") {
                            $("#err1").html("p has to be a prime");
                        }
                        else if (data[1] == "0") {
                            $("#err2").html("q has to be a prime");
                        }
                    }
                    else if (data.length == 5)
                        $("#err3").html("e is not a valid number, please read the example one more time!");
                    else {
                        // show steps here
                    }
                });
			});
		});


    </script>
</head>

<body>

<br/><br/><br/><br/><br/><br/>

<h1>Welcome to Cryptography Interactive Learning System!</h1>

<span class="color-picker"></span>

<br/><br/><br/>

<!-- <form action="_choose" onsubmit="return validateForm()" method="GET|POST"></form> -->
<span class="dropdown_leading">
    I want to learn: &nbsp&nbsp&nbsp
</span>
<span class="custom-dropdown big">
    <select name="cryptosystem" id="opt" onchange="show_text(); why_system(); toggle_visibility();" >
        <option value="none" selected disabled hidden>
            Select an Option
        </option>
        <option>RSA</option>
        <option>Diffie–Hellman key exchange</option>
        <option>ElGamal encryption</option>
    </select>
</span>

<br>

<!-- <span class="dropdown_leading">
    How it works? &nbsp&nbsp&nbsp&nbsp&nbsp
</span>
<div class="custom-dropdown big">
    <select name="en_de" id="ende" onchange="toggle_visibility(); show_text();">
        <option value="none" selected disabled hidden>
            Select an Option
        </option>
        <option>Encrypt</option>
        <option>Decrypt</option>
    </select>
</div> -->

<span id="whysys" onclick="click_motivation();">

</span>

<br/><br/>

<p class="title" id="word1"></p>

<p class="word" id="word2"></p>

<p class="word" id="word3"></p>

<p class="word" id="word4"></p>

<p class="word" id="word5"></p>

<p class="word" id="word6"></p>

<p class="word" id="word7"></p>

<p class="word" id="word8"></p>

<p class="word" id="word9"></p>

<p class="word" id="word10"></p>

<p class="word" id="word11"></p>

<p class="word" id="word12"></p>

<p class="word" id="word13"></p>

<p class="word" id="word14"></p>

<p class="word" id="word15"></p>

<p class="word" id="word16"></p>

<p class="word" id="word17"></p>

<p class="word" id="word18"></p>

<p class="word" id="word19"></p>

<p class="word" id="word20"></p>

<p class="word" id="word21"></p>

<p class="word" id="word22"></p>

<p class="word" id="word23"></p>

<p class="word" id="word24"></p>

<p class="word" id="word25"></p>

<p class="word" id="word26"></p>

<p class="word" id="word27"></p>

<p class="word" id="word28"></p>

<p class="word" id="word29"></p>

<p class="word" id="word30"></p>

<p class="word" id="word31"></p>

<p class="word" id="word32"></p>

<p class="word" id="word33"></p>

<p class="word" id="word34"></p>

<p class="word" id="word35"></p>

<p class="word" id="word36"></p>

<p class="word" id="word37"></p>

<p class="word" id="word38"></p>

<p class="word" id="word39"></p>

<p class="word" id="word40"></p>

<p class="word" id="word41"></p>

<p class="word" id="word42"></p>

<p class="word" id="word43"></p>

<p class="word" id="word44"></p>

<p class="word" id="word45"></p>

<p class="word" id="word46"></p>

<p class="word" id="word47"></p>

<p class="word" id="word48"></p>

<p class="word" id="word49"></p>

<p class="word" id="word50"></p>

<p class="word" id="word51"></p>

<p class="word" id="word52"></p>

<p class="word" id="word53"></p>

<p class="word" id="word54"></p>

<p class="word" id="word55"></p>

<p class="word" id="word56"></p>

<p class="word" id="word57"></p>

<p class="word" id="word58"></p>

<p class="word" id="word59"></p>

<p class="word" id="word60"></p>

<p class="word" id="word61"></p>

<p class="word" id="word62"></p>

<p class="word" id="word63"></p>

<p class="word" id="word64"></p>

<p class="word" id="word65"></p>

<p class="word" id="word66"></p>

<p class="word" id="word67"></p>

<p class="word" id="word68"></p>

<p class="word" id="word69"></p>

<p class="word" id="word70"></p>

<p class="word" id="word71"></p>

<p class="word" id="word72"></p>

<p class="word" id="word73"></p>

<p class="word" id="word74"></p>

<p class="word" id="word75"></p>

<br>

<span class="word" id="try_leading"></span> 
<button class="greyButt" id="tryButt">Yes!</button>

<br><br><br>

<label for="lname" class="box_leading" id="text1"></label>
<input type="text" class="box" id="input1" name="userInput1" placeholder="input a prime number here" onclick="show_dice1(); this.onclick=null;"><span>&nbsp&nbsp&nbsp</span><span id="img1"></span>
<p class="err" id="err1">&nbsp</p>
<br><br>
<label for="lname" class="box_leading" id="text2"></label>
<input type="text" class="box" id="input2" name="userInput2" placeholder="input a prime number here" onclick="show_dice2(); this.onclick=null;"><span>&nbsp&nbsp&nbsp</span><span id="img2"></span>
<p class="err" id="err2">&nbsp</p>
<br><br>
<label for="lname" class="box_leading" id="text3"></label>
<input type="text" class="box" id="input3" name="userInput3" placeholder="input an exponent here" onclick="show_dice3(); this.onclick=null;"><span>&nbsp&nbsp&nbsp</span><span id="img3"></span>
<p class="err" id="err3">&nbsp</p>
<br><br>
<label for="lname" class="box_leading" id="text4"></label>
<br><br>
<textarea type="text" class="text_box" id="input4" name="userInput4" rows="10" cols="70"></textarea>
<br/><br/><br/><br/><br/><br/>

<div>
    <button class="button" id="butt">Try it yourself!</button>
</div>


<!-- </form> -->
</body>
</html>